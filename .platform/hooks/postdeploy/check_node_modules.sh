#!/bin/sh

# Valida si existe una carpeta node_modules en el directorio /var/app/current/ y si no ejecuta npm install
if [ ! -d "/var/app/current/node_modules" ]; then
    echo "node_modules not found, executing npm install"
    cd /var/app/current

    # Install NVM
    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.5/install.sh | bash
    . ~/.nvm/nvm.sh
    # Install Node.js LTS
    nvm install 18 || nvm install --lts
    
    npm install
    npm run build
    echo "npm install executed successfully"

fi
